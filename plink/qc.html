<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR" xml:lang="pt-BR"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introdução a Análises Genômicas no PLINK - Controle de Qualidade</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../plink/diversity.html" rel="next">
<link href="../plink/runplink.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar"
  }
}</script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Controle de Qualidade</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/logoplink.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://paulobarros.com.br" title="paulobarros.com.br" class="sidebar-tool px-1"><i class="bi bi-globe"></i></a>
    <a href="https://github.com/paulobarros/curso-plink" title="Análises Genômicas no PLINK" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="https://twitter.com/pbarrosjr" title="Paulo Barros Twitter" class="sidebar-tool px-1"><i class="bi bi-twitter"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Apresentação</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../genomica/index.html" class="sidebar-item-text sidebar-link">Genômica</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../genomica/markers.html" class="sidebar-item-text sidebar-link">Marcadores Moleculares</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../genomica/snps.html" class="sidebar-item-text sidebar-link">SNP</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../genomica/sequenciamento.html" class="sidebar-item-text sidebar-link">Genotipagem</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../genomica/aplicacao.html" class="sidebar-item-text sidebar-link">Aplicações</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../plink/index.html" class="sidebar-item-text sidebar-link">PLINK</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plink/datafiles.html" class="sidebar-item-text sidebar-link">Arquivos de Entrada</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plink/runplink.html" class="sidebar-item-text sidebar-link">Rodando o PLINK</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plink/qc.html" class="sidebar-item-text sidebar-link active">Controle de Qualidade</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plink/diversity.html" class="sidebar-item-text sidebar-link">Estatísticas Básicas</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plink/pca.html" class="sidebar-item-text sidebar-link">PCA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plink/datasets.html" class="sidebar-item-text sidebar-link">Datasets</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Nesta página</h2>
   
  <ul>
  <li><a href="#arquivos-.ped-e-.map" id="toc-arquivos-.ped-e-.map" class="nav-link active" data-scroll-target="#arquivos-.ped-e-.map">Arquivos <code>.ped</code> e <code>.map</code></a></li>
  <li><a href="#editando-arquivos" id="toc-editando-arquivos" class="nav-link" data-scroll-target="#editando-arquivos">Editando arquivos</a></li>
  <li><a href="#criando-arquivos-binários" id="toc-criando-arquivos-binários" class="nav-link" data-scroll-target="#criando-arquivos-binários">Criando arquivos Binários</a></li>
  <li><a href="#parâmetros-do-qc" id="toc-parâmetros-do-qc" class="nav-link" data-scroll-target="#parâmetros-do-qc">Parâmetros do QC</a></li>
  <li><a href="#criando-script-de-qc" id="toc-criando-script-de-qc" class="nav-link" data-scroll-target="#criando-script-de-qc">Criando Script de QC</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/paulobarros/curso-plink/issues/new" class="toc-action">Criar uma issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Controle de Qualidade</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Para esta seção utilizaremos dados de marcadores SNP de cinco raças de Ovinos, num total de 119 indivíduos genotipados. Você pode consultar mais informações pra este dataset <a href="../plink/datasets.html#sheep">aqui</a>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ao longo dos exercícios utilizaremos diversas linguagens de script como <strong>AWK</strong>, <strong>SED</strong> e <strong>BASH</strong>. Infelizmente não é o objetivo deste curso ensinar essas linguagens, os scripts e exemplos serão descritos da melhor maneira possível, mas para aprofundar e conhecer melhor estas linguagens recomendo uma busca no Youtube, existem diversos canais excelentes que podem auxiliar no aprendizado destas linguagens.</p>
</div>
</div>
<section id="arquivos-.ped-e-.map" class="level3">
<h3 class="anchored" data-anchor-id="arquivos-.ped-e-.map">Arquivos <code>.ped</code> e <code>.map</code></h3>
<p>Vamos ver a estrutura dos nossos arquivos de entrada. Como <a href="../plink/datafiles.html">já discutimos</a>, o PLINK utiliza dois arquivos, um de genótipos e um de marcadores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">cut</span> <span class="at">-c-100</span> sheep.ped <span class="kw">|</span> <span class="fu">head</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>ADP ADP_3 0 0 0 U G G G C G G G G G A A A G G G C A A A A C A A A G G A A C G A A G G A A C A G C A 
ADP ADP_5 0 0 0 U G G C C G G G G G A A A A G C C G A G A C C G A G A G G C C G G G G A A C A G G G 
ADP ADP_6 0 0 0 U G A C C G A G A G A A A G G G C A A A A A A G A G A A G C C G G G G A A C A G C A 
ADP ADP_7 0 0 0 U G A C C G G G A G A A A A G G C A A G A C A A A G G A A C G A A G G A G C A G C G 
ADP ADP_8 0 0 0 U G A C C G G G A A A A A A G G C G A A A C A A A G G A G G G A A G G A A C A G C A 
ADP ADP_9 0 0 0 U G A C C G G G A G A A A A G C C G G A A C A A A G G G G C G A A G G A A C A G C A 
ADP ADP_11 0 0 0 U G G G C G G G G G A A A G G G C A A 0 0 C A A A G G A A G G A A G G A A C C G G A
ADP ADP_12 0 0 0 U G G C C G G G G G A A A G G G C G A G A C C A A G G A G C G G A G G A G C A G C A
ADP ADP_13 0 0 0 U G A C C G G G A A A A A A G G C G A A A C A A A G G A G C G A A G A A A C A G C A
ADP ADP_14 0 0 0 U G G C C G G G G G G A A G G G G G G A A C C A A G G A A C G G G G G A A C A G C G</code></pre>
<p>O arquivo <code>.ped</code> está completo (<a href="../plink/datafiles.html#colunas-iniciais">com as seis colunas iniciais</a>) e os <a href="../plink/datafiles.html#genótipos">marcadores codificados como bases nucleotidicas</a>. Nossa ID de família/população está na primeira coluna como <code>ADP</code>, se consultarmos nossa documentação do dataset veremos que é a abreviação para a raça <code>African Dorper</code>. Cada raça tem o seu ID único, assim como cada indivíduo dentro das populações, <code>ADP_3</code> é o ID do animal. Seguido das colunas de Pai, Mãe e Sexo, todas sem informação codificadas com <code>0</code> e a coluna de fenótipos codificada com a letra <code>U</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">cat</span> sheep.map <span class="kw">|</span> <span class="fu">head</span> </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>1 s64199.1 0 52854
1 OAR19_64675012.1 0 81978
1 OAR19_64715327.1 0 120098
1 OAR19_64803054.1 0 204694
1 DU281551_498.1 0 315497
1 s18939.1 0 357652
1 OAR1_88143.1 0 401196
1 s09912.1 0 489045
1 s36301.1 0 580814
1 s34880.1 0 643628
</code></pre>
<p>O arquivo <code>.map</code> também está no padrão que já discutimos, com a coluna do ID do cromossomo, ID do SNP, distância genética e a posição no genoma em pares de base. Utilizando o comando abaixo podemos descobrir quantos marcadores existem no total no nosso arquivo de mapa.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">wc</span> <span class="at">-l</span> sheep.map</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>46819 sheep.map
</code></pre>
<p>O comando <code>wc</code> significa “word count” e o argumento <code>-l</code> indica que você deseja contar o número de linhas. Vemos então que o nosso número total de marcadores é de <strong>46819 marcadores</strong>.</p>
<p>Podemos também consultar o número de indivíduos em cada população do nosso arquivo de genótipo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">awk</span> <span class="st">'{count[$1]++} END {for (word in count) print word, count[word]}'</span> sheep.ped</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>ADP 21
AWD 6
BMN 22
BSI 47
BCS 23
</code></pre>
<p>Explicando o comando:</p>
<ul>
<li><p><code>{count[$1]++}:</code> Isso irá contar as ocorrências de cada palavra na primeira coluna e armazená-las em um array chamado count. O <code>$1</code> refere-se à primeira coluna do arquivo, onde está o ID da população.</p></li>
<li><p><code>END {for (word in count) print word, count[word]}</code>: Isso irá percorrer o array count e imprimir cada palavra e sua respectiva contagem.</p></li>
</ul>
</section>
<section id="editando-arquivos" class="level3">
<h3 class="anchored" data-anchor-id="editando-arquivos">Editando arquivos</h3>
<p>Os dados que vamos utilizar estão todos em um único arquivo. Como a nossa intenção é realizar análises tanto dentro, quanto entre populações, o ideal é que façamos a edição dos arquivos de modo que cada população possua seus arquivos <code>.ped</code> e <code>.map</code> para as análises. Faremos estas edições utilizando comandos de terminal.</p>
<p>Temos 5 populações, assim, teremos no final 5 arquivos de genótipo. O arquivo de mapa é o mesmo para todas as populações, uma vez que foram genotipadas para o mesmo chip de marcadores. No meu exemplo, eu renomeei os arquivos <code>.ped</code> e <code>.map</code> para <code>toPlink_Ovis</code> respectivamente, para facilitar no trabalho com os dados.</p>
<section id="separando-as-populações" class="level4">
<h4 class="anchored" data-anchor-id="separando-as-populações">Separando as populações</h4>
<p>Para separar as populações vamos utilizar o código abaixo, basta copiar e colar no seu editor de texto e salvar com o nome de sua preferência desde que o formato seja <code>.sh</code>. No meu caso eu salvei este código num arquivo chamado <code>split_pop.sh</code>. Lembre de que para executar qualquer arquivo é necessário fornecer <a href="../plink/runplink.html#lst-chmod">permissão de execução</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># Array com 5 elementos contendo os padrões</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="va">populacoes</span><span class="op">=</span><span class="va">($(</span><span class="fu">awk</span> <span class="st">'!arr[$1]++ {print $1}'</span> toPlink_Ovis.ped<span class="va">))</span></span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co"># Loop através do array para processar cada padrão</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="cf">for</span> populacao <span class="kw">in</span> <span class="st">"</span><span class="va">${populacoes</span><span class="op">[@]</span><span class="va">}</span><span class="st">"</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="cf">do</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>    <span class="bu">echo</span> <span class="va">$populacao</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="co"># Cria um diretório com o nome do padrão (população)</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>    <span class="fu">mkdir</span> <span class="at">-p</span> <span class="st">"</span><span class="va">$populacao</span><span class="st">"</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>    </span>
<span id="cb9-13"><a href="#cb9-13"></a>    <span class="co">#Executa o comando AWK para o padrão atual e salva a saída em um arquivo</span></span>
<span id="cb9-14"><a href="#cb9-14"></a>    <span class="co"># dentro do dirétório criado para a população</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>    <span class="fu">awk</span> <span class="at">-v</span> pop=<span class="st">"</span><span class="va">$populacao</span><span class="st">"</span> <span class="st">'$1 ~ pop {print}'</span> <span class="dt">\</span></span>
<span id="cb9-16"><a href="#cb9-16"></a>    toPlink_Ovis.ped <span class="op">&gt;</span> <span class="st">"</span><span class="va">$populacao</span><span class="st">/</span><span class="va">$populacao</span><span class="st">"</span>_toPlink.ped</span>
<span id="cb9-17"><a href="#cb9-17"></a>    </span>
<span id="cb9-18"><a href="#cb9-18"></a>    <span class="fu">cp</span> toPlink_Ovis.map <span class="st">"</span><span class="va">$populacao</span><span class="st">/</span><span class="va">$populacao</span><span class="st">"</span>_toPlink.map</span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="cf">done</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A primeira linha <code>#!/usr/bin/env bash</code> informa o interpretador a ser usado para executar o script, que neste caso é o Bash.</p>
<p>A variável <code>populacoes</code> é definida como um array com 5 elementos contendo os padrões. A construção do array é feita usando o comando <code>awk</code>. Este comando busca no arquivo <code>toPlink_Ovis.ped</code> a primeira coluna que contém padrões, ou seja, linhas com valores únicos na primeira coluna. Cada padrão encontrado é armazenado em uma posição do array <code>populacoes</code>.</p>
<p>Em seguida, o script entra em um loop for que percorre cada elemento do array <code>populacoes</code>. Para cada elemento, o script executa as seguintes ações:</p>
<ul>
<li><p>Cria um diretório com o nome do padrão usando o comando <code>mkdir -p "$populacao"</code></p></li>
<li><p>Executa o comando <code>awk</code> dentro do diretório criado para buscar todas as linhas do arquivo <code>toPlink_Ovis.ped</code> que correspondem ao padrão atual, usando a variável <code>populacao</code> como argumento, e redireciona a saída para um arquivo com o nome <code>"populacao/populacao_toPlink.ped"</code></p></li>
<li><p>Copia o arquivo <code>toPlink_Ovis.map</code> para o diretório criado, com o nome <code>"populacao/populacao_toPlink.map"</code></p></li>
</ul>
<p>Resumindo, o script separa os dados do arquivo <code>toPlink_Ovis.ped</code> em diretórios separados com base nos padrões encontrados na primeira coluna, que no caso são os nomes das nossas populações, produzindo um arquivo <code>populacao_toPlink.ped</code> e um arquivo <code>populacao_toPlink.map</code> em cada diretório correspondente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1"></a><span class="ex">tree</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>.
├── ADP
│&nbsp;&nbsp; ├── ADP_toPlink.map
│&nbsp;&nbsp; └── ADP_toPlink.ped
├── AWD
│&nbsp;&nbsp; ├── AWD_toPlink.map
│&nbsp;&nbsp; └── AWD_toPlink.ped
├── BCS
│&nbsp;&nbsp; ├── BCS_toPlink.map
│&nbsp;&nbsp; └── BCS_toPlink.ped
├── BMN
│&nbsp;&nbsp; ├── BMN_toPlink.map
│&nbsp;&nbsp; └── BMN_toPlink.ped
├── BSI
│&nbsp;&nbsp; ├── BSI_toPlink.map
│&nbsp;&nbsp; └── BSI_toPlink.ped
├── licensed_data.txt
├── marker_ID_info.txt
├── plink
├── selection.txt
├── split_pop.sh
├── toPlink_Ovis.map
└── toPlink_Ovis.ped
</code></pre>
</section>
</section>
<section id="criando-arquivos-binários" class="level3">
<h3 class="anchored" data-anchor-id="criando-arquivos-binários">Criando arquivos Binários</h3>
<p>Como já discutimos, a depender do número de marcadores, pode ser mais eficiente que transformemos os nossos arquivos de genótipo e mapa em um arquivo binário. O PLINK faz isso de forma automática para nós por meio de uma <em>flag</em> de comando. A partir de agora faremos a importação dos arquivos, a transformação para o formato binário, e todo o processo de controle de qualidade em um único comando. Primeiro vamos entender as <em>flags</em> que utilizaremos para o QC no PLINK. Depois criaremos um novo script em Bash que fará os passos necessários para nosso controle de qualidade para cada população.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1"></a><span class="ex">plink</span> <span class="at">--file</span> arquivo.ped <span class="dt">\</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>    <span class="at">--maf</span> 0.05 <span class="dt">\</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>    <span class="at">--geno</span> 0.05 <span class="dt">\</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>    <span class="at">--mind</span> 0.10 <span class="dt">\</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>    <span class="at">--hwe</span> 1e-60 midp include-nonctrl <span class="dt">\</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>    <span class="at">--nonfounders</span> <span class="dt">\</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>    <span class="at">--sheep</span> <span class="dt">\</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>    <span class="at">--allow-extra-chr</span> <span class="dt">\</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>    <span class="at">--indep-pairwise</span> 50 5 0.4 <span class="dt">\</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>    <span class="at">--make-bed</span> <span class="dt">\</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>    <span class="at">--threads</span> 8 <span class="dt">\</span></span>
<span id="cb12-12"><a href="#cb12-12"></a>    <span class="at">--out</span> binary</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Agora vamos entender tudo o que está acontecendo no código acima:</p>
<ul>
<li><p><code>--file arquivo.ped</code>: Especifica o nome do arquivo PED a ser utilizado como entrada. Esse arquivo contém informações sobre as amostras genéticas e seus genótipos.</p></li>
<li><p><code>--maf 0.05</code>: Remove todos os loci com frequência alélica menor do que 0,05. Isso significa que apenas loci com pelo menos 5% dos alelos terão suas informações preservadas.</p></li>
<li><p><code>--geno 0.05</code>: Remove todos os indivíduos com mais de 5% dos loci genotipados ausentes (faltantes). Isso significa que os indivíduos que têm muitos dados ausentes serão removidos da análise.</p></li>
<li><p><code>--mind 0.10</code>: Remove todos os loci com mais de 10% dos genótipos faltantes. Isso significa que os loci que têm muitos dados ausentes serão removidos da análise.</p></li>
<li><p><code>--hwe 1e-60 midp include-nonctrl</code>: Remove todos os loci que apresentam desequilíbrio de Hardy-Weinberg (HWE) com valor de p menor do que 1e-60 (1x10<sup>-60</sup>). O parâmetro <code>midp</code> é utilizado para calcular o valor de <em>p</em> e a opção <code>include-nonctrl</code> especifica que devem ser incluídos no cálculo os indivíduos que não são controles.</p></li>
<li><p><code>--nonfounders</code>: Remove todos os indivíduos que não são fundadores, ou seja, indivíduos que têm pelo menos um pai no arquivo de entrada.</p></li>
<li><p><code>--sheep</code>: Especifica que os dados são de ovinos.</p></li>
<li><p><code>--allow-extra-chr</code>: Permite a inclusão de cromossomos extras.</p></li>
<li><p><code>--indep-pairwise 50 5 0.4</code>: Realiza a análise de <strong>LD pruning</strong>, ou seja, remove marcadores que estão em desequilíbrio de ligação (LD) uns com os outros. Nesse caso, ele irá reter apenas um marcador de cada par de marcadores que têm uma correlação maior do que 0,4, dentro de janelas de 50 SNPs e passo de 5 SNPs.</p></li>
<li><p><code>--make-bed</code>: Especifica que o arquivo de saída será no formato BED, que é um <strong>formato de arquivo binário</strong> usado pelo PLINK.</p></li>
<li><p><code>--threads 8</code>: Especifica o número de threads (ou processos paralelos) que serão utilizados na análise.</p></li>
<li><p><code>--out binary</code>: Especifica o nome do arquivo de saída. Nesse caso, o arquivo de saída será chamado “binary”.</p></li>
</ul>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>Quando o PLINK faz a leitura das <em>flags</em>, ele as lê de maneira sequencial. Como são muitas, a depender da análise, escrever o script em BASH fica mais legível do que tentar copiar inúmeras flags em sequência no terminal. O caracter de <code>\</code> em um script BASH informa ao terminal uma quebra de linha, isso facilita a legibilidade do código, mas internamente, na execução do programa, os comando são lidos como se estivessem em uma única linha de código.</p>
</div>
</div>
<p>Duas flags importantes a observar no comando PLINK acima. A flag <code>--file</code> indica que ainda estamos fazendo a leitura de um arquivo <code>.ped</code>. E a flag <code>--make-bed</code> é o comando que converte nossos arquivos em um formato binário.</p>
</section>
<section id="parâmetros-do-qc" class="level3">
<h3 class="anchored" data-anchor-id="parâmetros-do-qc">Parâmetros do QC</h3>
<p>É importante compreender os parâmetros adotados no QC (<em>quality control</em>). Alguns parâmetros são já estabelecidos como base na literatura, mas outros dependem da especificidade do projeto, dos objetivos e principalmente do número de marcadores disponíveis. De modo mais simples, quando trabalhamos com chips de alta densidade, com um número grande de marcadores, podemos ser mais restritivos quanto a alguns dos parâmetros do QC, eliminando assim um número maior de marcadores. Entretanto, se trabalhamos com poucas amostras e um chip de baixa densidade de marcadores, deve-se levar em consideração o objetivo do trabalho e o quanto mais flexíveis podemos ser em relação ao QC visando maximizar o número de marcadores restantes, sem prejudicar a acurácia das estatísticas obtidas. Uma boa discussão sobre QC em estudos de GWAS veja Gondro <span class="citation" data-cites="gondro2013genome gondro2014snpqc">[<a href="#ref-gondro2013genome" role="doc-biblioref">1</a>,<a href="#ref-gondro2014snpqc" role="doc-biblioref">2</a>]</span>.</p>
</section>
<section id="criando-script-de-qc" class="level3">
<h3 class="anchored" data-anchor-id="criando-script-de-qc">Criando Script de QC</h3>
<p>Vamos agora criar um script em BASH que navegue pelos diretórios onde encontram-se os dados de cada população, e gere nossos arquivos binários e faça também o QC para cada população. Novamente, basta criar um arquivo com extensão <code>.sh</code> e executar. No meu caso chamei de <code>pop_QC.sh</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">#!/usr/bin/env bash</span></span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co"># Array com 5 elementos contendo os padrões</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="va">populacoes</span><span class="op">=</span><span class="va">($(</span><span class="fu">awk</span> <span class="st">'!arr[$1]++ {print $1}'</span> toPlink_Ovis.ped<span class="va">))</span></span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co"># Loop para realização do QC em cada população</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co"># e criação dos arquivos Binários</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="cf">for</span> populacao <span class="kw">in</span> <span class="st">"</span><span class="va">${populacoes</span><span class="op">[@]</span><span class="va">}</span><span class="st">"</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="cf">do</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>    <span class="bu">echo</span> <span class="st">"Realizando QC para a população: </span><span class="va">$populacao</span><span class="st"> ..."</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>    <span class="bu">cd</span> <span class="st">"</span><span class="va">$populacao</span><span class="st">"</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>    </span>
<span id="cb13-13"><a href="#cb13-13"></a>    <span class="ex">plink</span> <span class="at">--file</span> <span class="st">"</span><span class="va">$populacao</span><span class="st">"</span>_toPlink <span class="dt">\</span></span>
<span id="cb13-14"><a href="#cb13-14"></a>    <span class="at">--maf</span> 0.05 <span class="dt">\</span></span>
<span id="cb13-15"><a href="#cb13-15"></a>    <span class="at">--geno</span> 0.05 <span class="dt">\</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>    <span class="at">--mind</span> 0.10 <span class="dt">\</span></span>
<span id="cb13-17"><a href="#cb13-17"></a>    <span class="at">--hwe</span> 1e-60 midp include-nonctrl <span class="dt">\</span></span>
<span id="cb13-18"><a href="#cb13-18"></a>    <span class="at">--nonfounders</span> <span class="dt">\</span></span>
<span id="cb13-19"><a href="#cb13-19"></a>    <span class="at">--sheep</span> <span class="dt">\</span></span>
<span id="cb13-20"><a href="#cb13-20"></a>    <span class="at">--allow-extra-chr</span> <span class="dt">\</span></span>
<span id="cb13-21"><a href="#cb13-21"></a>    <span class="at">--indep-pairwise</span> 50 5 0.4 <span class="dt">\</span></span>
<span id="cb13-22"><a href="#cb13-22"></a>    <span class="at">--make-bed</span> <span class="dt">\</span></span>
<span id="cb13-23"><a href="#cb13-23"></a>    <span class="at">--threads</span> 8 <span class="dt">\</span></span>
<span id="cb13-24"><a href="#cb13-24"></a>    <span class="at">--out</span> binary</span>
<span id="cb13-25"><a href="#cb13-25"></a>    </span>
<span id="cb13-26"><a href="#cb13-26"></a>    <span class="bu">echo</span> <span class="st">"QC e Arquivos binários criados para </span><span class="va">$populacao</span><span class="st"> !"</span></span>
<span id="cb13-27"><a href="#cb13-27"></a>    <span class="bu">cd</span> ..</span>
<span id="cb13-28"><a href="#cb13-28"></a>    </span>
<span id="cb13-29"><a href="#cb13-29"></a>    </span>
<span id="cb13-30"><a href="#cb13-30"></a><span class="cf">done</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A primeira linha <code>#!/usr/bin/env bash</code> indica que o interpretador de comandos utilizado será o bash.</p>
<p>A linha seguinte cria um array chamado <code>populacoes</code> que armazena os nomes das populações presentes no arquivo <code>toPlink_Ovis.ped</code>. O comando <code>awk</code> é usado para identificar os nomes únicos de população na primeira coluna do arquivo <code>toPlink_Ovis.ped</code> e armazená-los em um array.</p>
<p>Em seguida, o script utiliza um loop for para iterar através de cada população no array <code>populacoes</code>. Para cada população, o script muda para o diretório correspondente utilizando o comando <code>cd</code> e, em seguida, executa o comando PLINK (que foi explicado no passo anterior) para realizar o QC e criar os arquivos binários para essa população.</p>
<p>O comando <code>echo</code> é usado para imprimir uma mensagem informando qual população está sendo processada e quando os arquivos binários foram criados. O comando <code>cd ..</code> é usado para voltar ao diretório original antes de prosseguir para a próxima população.</p>
<p>Se tudo deu certo, veremos que nas pastas das nossas populações temos agora os arquivos binários criados pelo PLINK, bem como outros arquivos de suporte.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1"></a><span class="ex">tree</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>.
├── ADP_toPlink.map
├── ADP_toPlink.ped
├── binary.bed
├── binary.bim
├── binary.fam
├── binary.log
├── binary.nosex
├── binary.prune.in
└── binary.prune.out
</code></pre>
<p>Temos os nossos arquivos <code>.ped</code> e <code>.map</code> originais da população. O PLINK criou uma série de arquivos com o nome <code>binary</code> já que esta foi a opção de saída que informamos com a flag <code>--out</code>. Os arquivos com extensão <code>.bed</code>, <code>.bim</code> e <code>.fam</code> são os novos arquivos que o PLINK utilizará nas análises seguintes. O arquivo <code>.log</code> é muito importante pois é um registro de todos os passos que foram realizados na execução do código, nele podemos identificar as mensagens de erro caso ocorram, o que é mais fácil do que rolar o terminal. O arquivo <code>.nosex</code> contém as informações sobre o sexo dos indivíduos no arquivo de genótipo. No nosso caso, como não temos a informação de sexo, vocês verão que o que consta neste arquivo é simplesmente o ID da Família/População e do indivíduo.</p>
<p>Dois arquivos são extremamente importantes, os arquivos <code>.prune.in</code> e <code>prune.out</code>. São os arquivos que contém as informações de <em>prunning</em> (filtro) dos marcadores. O arquivo <code>.in</code> possui a ID dos marcadores que passaram no QC, e o <code>.out</code> os marcadores que foram removidos por falhar no QC. Estes arquivos contém somente o identificador do SNP, então podemos facilmente saber o número de marcadores excluídos no processo de QC para esta população.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">wc</span> <span class="at">-l</span> binary.prune.out</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>26982 binary.prune.out</code></pre>
<p>Nosso número original de marcadores era de 46819 SNPs. Isso significa que aproximadamente 57% dos marcadores para esta população foram removidos com base nos nossos parâmetros de QC. Um número bastante significativo. Faça o exercício de rodar novamente o QC para esta população alterando alguns dos parâmetros do QC e veja a diferença no número de marcadores mantidos ou excluídos. Principalmente em parâmetros relacionados a LD como <code>--indep-pairwise 50 5 0.4</code>. Consulte a <a href="https://www.cog-genomics.org/plink/1.9/ld#indep">documentação do PLINK</a> caso tenha dúvidas em como alterar esta flag.</p>
<div id="refs" class="references csl-bib-body" role="doc-bibliography">
<p><strong>Referências</strong></p>
<div id="ref-gondro2013genome" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Gondro C, Van der Werf J, Hayes B. Genome-wide association studies and genomic prediction. Springer; 2013. </div>
</div>
<div id="ref-gondro2014snpqc" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Gondro C, Porto-Neto LR, Lee SH. snpqc–an R pipeline for quality control of I llumina SNP genotyping array data. Animal genetics. 2014;45: 758–761. </div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../plink/runplink.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Rodando o PLINK</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../plink/diversity.html" class="pagination-link">
        <span class="nav-page-text">Estatísticas Básicas</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left"><img src="https://raw.githubusercontent.com/paulobarros/curso-plink/8a1fe450d1a9d349ac7ec58d235748309fd786d0/images/frogbird.png" height="45" alt="Caption"> &nbsp; <strong>© CC-By Paulo Barros, 2023</strong></div>   
    <div class="nav-footer-right">This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>